# Overview

![](https://user-gold-cdn.xitu.io/2018/10/15/166786b5cf6d7f95?imageView2/0/w/1280/h/960/format/webp/ignore-error/1)



# 程序计数器

它表示当前所执行的字节码的行号指示器。如果正在执行的是本地（Native）方法，这个计数器就应该为空（Undefined）。此内存区域是唯一一个在《Java 虚拟机规范》中没有规定任何`OutOfMemoryError`情况的区域。



# Java虚拟机栈

局部变量表存放了编译器可知的各种Java基本数据类型，对象引用类型和`returnAddress`（指向了一条字节码指令的地址）类型。

如果线程请求的栈深度大于了虚拟机所允许的深度，将抛出`StackOverflowError`异常。如果栈可以动态扩展，那么当栈扩展时无法申请到足够的内存就会抛出`OutOfMemoryError`异常。



# 本地方法栈

和Java虚拟机栈的区别在于，本地方法栈是为虚拟机使用到的本地方法服务。有的虚拟机（如HotSpot）就将二者合二为一。其异常机制和Java虚拟机栈一致。

<font color="red">HotSpot虚拟机的栈容量是不可以动态扩展的，以前的Classic则可以。所以在HotSpot虚拟机上是不会由于虚拟机栈无法扩展而产生`OutOfMemory`异常的。只要一开始申请成功了，就不会出现该异常，当然如果申请失败，则会出现。</font>

# Java堆

Java堆可以处于物理上不连续的内存空间中，但在逻辑上它应该被视为连续的。如果在Java堆中没有内存完成实例分配，并且堆也无法在扩展时，Java虚拟机将会抛出`OutOfMemoryError`异常。



# 方法区

方法区与Java堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等数据。



该区域的内存回收主要是针对常量池的回收和对类型的卸载。



# 运行时常量池

该区域是方法区的一部分。

